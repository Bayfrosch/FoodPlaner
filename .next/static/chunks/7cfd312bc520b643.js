(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,r)=>{t.exports=e.r(76562)},26998,e=>{"use strict";let t=async(e,t={})=>{let r=localStorage.getItem("token"),s={"Content-Type":"application/json",...t.headers};r&&(s.Authorization=`Bearer ${r}`);let o=await fetch(`/api${e}`,{...t,headers:s});if(!o.ok){let e={error:"API Error"};try{let t=o.headers.get("content-type");e=t?.includes("application/json")?await o.json():{error:`HTTP ${o.status}: ${o.statusText}`}}catch(t){e={error:`HTTP ${o.status}: ${o.statusText}`}}if(401===o.status){let e="/login"===window.location.pathname,t="/register"===window.location.pathname;e||t||(localStorage.removeItem("token"),localStorage.removeItem("userId"),window.location.href="/login")}throw Error(e.error||"API Error")}return o.json()};e.s(["auth",0,{register:(e,r)=>t("/auth/register",{method:"POST",body:JSON.stringify({username:e,password:r})}),login:(e,r)=>t("/auth/login",{method:"POST",body:JSON.stringify({username:e,password:r})}),me:()=>t("/auth/me"),updateProfile:(e,r)=>t("/auth/profile",{method:"PUT",body:JSON.stringify({currentPassword:e,newPassword:r})}),logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("userId")}},"collaborators",0,{getAll:e=>t(`/lists/${e}/collaborators`),invite:(e,r,s)=>t(`/lists/${e}/collaborators`,{method:"POST",body:JSON.stringify({username:r,role:s})}),add:(e,r,s)=>t(`/lists/${e}/collaborators`,{method:"POST",body:JSON.stringify({userId:r,role:s})}),update:(e,r,s)=>t(`/lists/${e}/collaborators/${r}`,{method:"PUT",body:JSON.stringify({role:s})}),remove:(e,r)=>t(`/lists/${e}/collaborators/${r}`,{method:"DELETE"}),accept:(e,r)=>t(`/lists/${e}/collaborators/${r}/accept`,{method:"POST"})},"items",0,{getAll:e=>t(`/lists/${e}/items`),create:(e,r)=>t(`/lists/${e}/items`,{method:"POST",body:JSON.stringify({name:r})}),update:(e,r,s)=>t(`/lists/${e}/items/${r}`,{method:"PUT",body:JSON.stringify({completed:s})}),updateCategory:(e,r,s)=>t(`/lists/${e}/items/${r}`,{method:"PUT",body:JSON.stringify({category:s})}),delete:(e,r)=>t(`/lists/${e}/items/${r}`,{method:"DELETE"})},"lists",0,{getAll:()=>t("/lists"),getById:e=>t(`/lists/${e}`),create:(e,r="")=>t("/lists",{method:"POST",body:JSON.stringify({title:e,description:r})}),update:(e,r,s)=>t(`/lists/${e}`,{method:"PUT",body:JSON.stringify({title:r,description:s})}),delete:e=>t(`/lists/${e}`,{method:"DELETE"}),getCategories:e=>t(`/lists/${e}/categories`),syncCategory:(e,r,s)=>t(`/lists/${e}/categories`,{method:"POST",body:JSON.stringify({itemName:r,category:s})}),deleteCategory:(e,r)=>t(`/lists/${e}/categories/${encodeURIComponent(r)}`,{method:"DELETE"}),getCategoryOrder:e=>t(`/lists/${e}/categories/order`),updateCategoryOrder:(e,r)=>t(`/lists/${e}/categories/order`,{method:"PUT",body:JSON.stringify({categories:r})})},"recipes",0,{getAll:()=>t("/recipes"),getById:e=>t(`/recipes/${e}`),create:(e,r="",s=[])=>t("/recipes",{method:"POST",body:JSON.stringify({title:e,description:r,items:s})}),update:(e,r,s,o)=>t(`/recipes/${e}`,{method:"PUT",body:JSON.stringify({title:r,description:s,items:o})}),delete:e=>t(`/recipes/${e}`,{method:"DELETE"}),addItem:(e,r)=>t(`/recipes/${e}/items`,{method:"POST",body:JSON.stringify({name:r})}),deleteItem:(e,r)=>t(`/recipes/${e}/items/${r}`,{method:"DELETE"}),addToList:(e,r,s)=>t(`/recipes/${e}/add-to-list`,{method:"POST",body:JSON.stringify({listId:r,selectedItemIds:s})})}])},21731,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(18566),o=e.i(26998);class l{abortController=null;listId=null;callbacks=new Set;reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=1e3;isAborting=!1;subscribe(e,t){return this.callbacks.add(t),this.listId===e&&this.abortController||this.connect(e),()=>{this.callbacks.delete(t),0===this.callbacks.size&&this.disconnect()}}async connect(e){if(this.listId=e,this.abortController&&!this.isAborting){this.isAborting=!0;try{!1===this.abortController.signal.aborted&&this.abortController.abort()}catch(e){console.debug("[SSE Client] Abort error (expected):",e instanceof Error?e.message:String(e))}this.isAborting=!1}this.abortController=new AbortController;let t=window.location.origin,r=localStorage.getItem("token"),s=`${t}/api/lists/${e}/updates`;console.log("[SSE Client] Attempting to connect to",s);try{let t=await fetch(s,{method:"GET",headers:{Authorization:`Bearer ${r}`},signal:this.abortController.signal});if(console.log("[SSE Client] Response status:",t.status,t.statusText),!t.ok){let e=await t.text();console.error("[SSE Client] HTTP error:",t.status,e),this.handleConnectionError();return}if(!t.body){console.error("[SSE Client] No response body"),this.handleConnectionError();return}console.log("[SSE Client] Connected to list",e),await this.readStream(t.body)}catch(e){e instanceof Error&&"AbortError"===e.name?console.log("[SSE Client] Connection aborted"):e instanceof TypeError&&e.message.includes("BodyStreamBuffer")?console.log("[SSE Client] Stream was aborted during read"):(console.error("[SSE Client] Connection error:",e),this.handleConnectionError())}}async readStream(e){let t=e.getReader(),r=new TextDecoder,s="";try{for(;;){if(this.abortController?.signal.aborted){console.log("[SSE Client] Stream aborted, stopping read");break}let{done:e,value:o}=await t.read();if(e){console.log("[SSE Client] Stream ended"),this.handleConnectionError();break}let l=(s+=r.decode(o,{stream:!0})).split("\n");for(let e of(s=l.pop()||"",l))if(e.startsWith("data: ")){let t=e.slice(6);try{let e=JSON.parse(t);this.broadcastToCallbacks(e),this.reconnectAttempts=0}catch(e){console.error("[SSE Client] Failed to parse message:",e,"raw:",t)}}}}catch(e){if(e instanceof Error){if("AbortError"===e.name||e.message.includes("aborted"))return void console.log("[SSE Client] Stream read aborted");else if(e.message.includes("BodyStreamBuffer"))return void console.log("[SSE Client] Stream buffer was aborted (expected)")}console.error("[SSE Client] Stream read error:",e),this.handleConnectionError()}finally{try{t.releaseLock()}catch(e){console.debug("[SSE Client] Reader lock release error (expected):",e instanceof Error?e.message:String(e))}}}handleConnectionError(){if(this.reconnectAttempts<this.maxReconnectAttempts&&this.listId){let e=this.reconnectDelay*Math.pow(2,this.reconnectAttempts);console.log("[SSE Client] Reconnecting in ${delay}ms (attempt ${this.reconnectAttempts + 1}/${this.maxReconnectAttempts})"),setTimeout(()=>{this.reconnectAttempts++,this.listId&&this.connect(this.listId)},e)}else console.error("[SSE Client] Connection failed after maximum reconnection attempts")}broadcastToCallbacks(e){this.callbacks.forEach(t=>{try{t(e)}catch(e){console.error("[SSE Client] Error in callback:",e)}})}disconnect(){if(this.abortController&&!this.isAborting){this.isAborting=!0;try{!1===this.abortController.signal.aborted&&this.abortController.abort()}catch(e){console.debug("[SSE Client] Disconnect abort error (expected):",e instanceof Error?e.message:String(e))}this.isAborting=!1,this.abortController=null}this.listId=null,this.callbacks.clear(),this.reconnectAttempts=0,console.log("[SSE Client] Disconnected")}isConnected(){return null!==this.abortController}}let a=new l;function i({listId:e,onClose:s}){let[l,a]=(0,r.useState)([]),[i,n]=(0,r.useState)(!1),[d,c]=(0,r.useState)(""),[m,u]=(0,r.useState)(""),[h,p]=(0,r.useState)(!1),[x,g]=(0,r.useState)(!0),[b,f]=(0,r.useState)(""),[y,v]=(0,r.useState)("viewer"),[w,j]=(0,r.useState)(!1);(0,r.useEffect)(()=>{N(),S()},[e]);let N=async()=>{try{g(!0);let[t,r]=await Promise.all([o.auth.me(),o.lists.getById(e)]);p(t.id===r.ownerId)}catch(e){console.error("Could not check ownership:",e),p(!1)}finally{g(!1)}},S=async()=>{try{n(!0);let t=await o.collaborators.getAll(e);a(t)}catch(e){c(e instanceof Error?e.message:"Fehler beim Laden der Kollaboratoren"),console.error(e)}finally{n(!1)}},k=async t=>{if(t.preventDefault(),c(""),u(""),!b.trim())return void c("Benutzername erforderlich");j(!0);try{await o.collaborators.invite(e,b,y),u("Einladung erfolgreich versendet!"),f(""),v("viewer"),setTimeout(()=>S(),500)}catch(e){c(e instanceof Error?e.message:"Fehler beim Versenden der Einladung")}finally{j(!1)}},C=async t=>{if(confirm("Diesen Nutzer entfernen?"))try{await o.collaborators.remove(e,t),u("Nutzer entfernt"),S()}catch(e){c(e instanceof Error?e.message:"Fehler beim Entfernen")}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"bg-gradient-to-br from-[#14141f]/95 to-[#1a1a2e]/95 backdrop-blur-xl border border-purple-500/30 rounded-3xl max-w-md w-full shadow-2xl shadow-purple-500/30",children:(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Liste teilen"}),(0,t.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-300 text-lg font-bold",children:"Close"})]}),d&&(0,t.jsx)("div",{className:"bg-red-500/10 border border-red-500/30 text-red-400 px-4 py-3 rounded-xl text-sm mb-4 backdrop-blur-sm",children:d}),m&&(0,t.jsx)("div",{className:"bg-green-500/10 border border-green-500/30 text-green-400 px-4 py-3 rounded-xl text-sm mb-4 backdrop-blur-sm",children:m}),!x&&!h&&(0,t.jsx)("div",{className:"bg-yellow-500/10 border border-yellow-500/30 text-yellow-400 px-4 py-3 rounded-xl text-sm mb-4 backdrop-blur-sm",children:"Du kannst Kollaboratoren nur hinzufügen, wenn du der Besitzer der Liste bist."}),h&&(0,t.jsxs)("form",{onSubmit:k,className:"mb-6 pb-6 border-b border-purple-500/20",children:[(0,t.jsx)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:"Benutzername"}),(0,t.jsx)("input",{type:"text",value:b,onChange:e=>f(e.target.value),placeholder:"benutzername",className:"w-full px-4 py-2 bg-[#1a1a2e] border border-purple-500/30 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-purple-400 focus:ring-2 focus:ring-purple-500/30 transition-all mb-3",required:!0}),(0,t.jsx)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:"Berechtigung"}),(0,t.jsxs)("select",{value:y,onChange:e=>v(e.target.value),className:"w-full px-4 py-2 bg-[#1a1a2e] border border-purple-500/30 rounded-xl text-white focus:outline-none focus:border-purple-400 focus:ring-2 focus:ring-purple-500/30 transition-all mb-4",children:[(0,t.jsx)("option",{value:"viewer",children:"Betrachter (nur lesen)"}),(0,t.jsx)("option",{value:"editor",children:"Bearbeiter (bearbeiten)"})]}),(0,t.jsx)("button",{type:"submit",disabled:w,className:"w-full px-4 py-2 text-white bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 disabled:from-gray-600 disabled:to-gray-700 rounded-xl font-bold transition-all shadow-lg shadow-purple-500/40",children:w?"Wird eingeladen...":"Einladen"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-sm font-bold text-gray-300 mb-3",children:["Kollaboratoren (",l.length,")"]}),i?(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Lädt..."}):0===l.length?(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Keine Kollaboratoren"}):(0,t.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:l.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-[#1a1a2e] border border-purple-500/20 rounded-xl",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-white text-sm font-medium",children:e.username}),(0,t.jsx)("p",{className:"text-gray-400 text-xs",children:"editor"===e.role?"Bearbeiter":"Betrachter"})]}),(0,t.jsx)("button",{onClick:()=>C(e.id),className:"p-1 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded transition-all",title:"Entfernen",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},e.id))})]})]})})})}let n=[];function d({id:e,name:s,category:l,completed:a,listId:i,customCategories:d,recipeName:c,onToggle:m,onDelete:u,onCategoryChange:h,onAddCategory:p,onDeleteCategory:x,isViewer:g=!1}){let b,[f,y]=(0,r.useState)(!1),[v,w]=(0,r.useState)(!1),[j,N]=(0,r.useState)(""),S=(0,r.useRef)(null),k=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{if(k.current){let t=k.current.contains(e.target);1===e.target.nodeType&&e.target.closest("[data-category-menu]")||t||!f||y(!1)}};return f&&document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[f]);let C=async t=>{w(!0);try{await o.items.updateCategory(i,e,t),await o.lists.syncCategory(i,s,t),y(!1),N(""),h()}catch(e){console.error("Fehler beim Aktualisieren der Kategorie:",e)}finally{w(!1)}},E=async()=>{j.trim()&&(await C(j.trim()),p(j.trim()))},$=[...new Set([...n,...d])];return(0,t.jsxs)("li",{className:"p-4 hover:bg-[#1a1a2e] flex items-center gap-4 transition-all group relative overflow-visible",children:[(0,t.jsxs)("label",{className:"flex items-center gap-4 flex-1 cursor-pointer min-w-0",children:[(0,t.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,t.jsx)("input",{type:"checkbox",checked:a,onChange:()=>!g&&m(e,a),disabled:g,className:"peer w-6 h-6 cursor-pointer appearance-none bg-[#1a1a2e] border-2 border-[#2d2d3f] rounded-lg checked:bg-gradient-to-br checked:from-purple-500 checked:to-purple-600 checked:border-purple-500 transition-all disabled:opacity-50 disabled:cursor-not-allowed"}),(0,t.jsx)("svg",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-4 h-4 text-white pointer-events-none opacity-0 peer-checked:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("span",{className:`block transition-all truncate ${a?"text-gray-500 line-through":"text-gray-200"}`,children:s}),c&&(0,t.jsxs)("span",{className:"text-xs text-blue-400 block mt-1",children:["Rezept: ",c]}),l&&(0,t.jsx)("span",{className:"text-xs text-purple-400 block mt-1",children:l})]})]}),(0,t.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,t.jsx)("button",{ref:k,onClick:()=>!g&&y(!f),disabled:g,className:"p-2 text-gray-400 hover:text-purple-400 hover:bg-purple-500/10 rounded-lg transition-all opacity-100 sm:opacity-0 sm:group-hover:opacity-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Kategorie ändern",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),f&&k.current&&(b=k.current.getBoundingClientRect(),(0,t.jsxs)("div",{ref:S,"data-category-menu":!0,onClick:e=>e.stopPropagation(),style:{position:"fixed",top:`${b.bottom+8}px`,right:`${window.innerWidth-b.right}px`},className:"bg-[#1a1a2e] border border-[#2d2d3f] rounded-lg shadow-2xl z-50 min-w-40 max-h-64 overflow-y-auto",children:[(0,t.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),C(null)},disabled:v,className:"w-full text-left px-4 py-2 text-gray-400 hover:text-white hover:bg-purple-500/10 transition-all text-sm border-b border-[#2d2d3f] disabled:opacity-50",children:"Keine Kategorie"}),$.map(e=>(0,t.jsxs)("div",{className:"border-b border-[#2d2d3f] flex items-center group",children:[(0,t.jsx)("button",{type:"button",onClick:t=>{t.preventDefault(),t.stopPropagation(),C(e)},disabled:v,className:`flex-1 text-left px-4 py-2 transition-all text-sm disabled:opacity-50 ${l===e?"bg-purple-500/20 text-purple-300":"text-gray-400 hover:text-white hover:bg-purple-500/10"}`,children:e}),(0,t.jsx)("button",{type:"button",onClick:t=>{t.preventDefault(),t.stopPropagation(),confirm(`Kategorie "${e}" l\xf6schen?`)&&x(e)},className:"text-red-400 hover:text-red-300 p-2 opacity-0 group-hover:opacity-100 hover:bg-red-500/20 rounded transition-all mx-1",title:"Kategorie löschen",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"})})})]},e)),(0,t.jsxs)("div",{className:"px-4 py-3 border-t border-[#2d2d3f] bg-[#0a0a0f]",children:[(0,t.jsx)("input",{type:"text",placeholder:"Neue Kategorie",value:j,onChange:e=>{e.stopPropagation(),N(e.target.value)},onKeyDown:e=>{e.stopPropagation(),"Enter"===e.key&&E()},className:"w-full bg-[#1a1a2e] border border-[#2d2d3f] rounded px-3 py-2 text-sm text-white placeholder-gray-500 focus:outline-none focus:border-purple-500"}),(0,t.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),E()},disabled:v||!j.trim(),className:"w-full mt-2 px-3 py-1 bg-purple-500/20 hover:bg-purple-500/30 text-purple-300 text-sm rounded transition-all disabled:opacity-50",children:"Hinzufügen"})]})]}))]}),(0,t.jsx)("button",{onClick:()=>!g&&u(e),disabled:g,className:"p-2 text-red-400 hover:text-red-300 hover:bg-red-500/20 rounded-lg transition-all opacity-100 sm:opacity-0 sm:group-hover:opacity-100 flex-shrink-0 disabled:opacity-50 disabled:cursor-not-allowed",title:"Löschen",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})}function c(){let e,l=(0,s.useRouter)(),n=(0,s.useParams)(),c=n?.listId,[m,u]=(0,r.useState)(null),[h,p]=(0,r.useState)([]),[x,g]=(0,r.useState)(""),[b,f]=(0,r.useState)(!1),[y,v]=(0,r.useState)(""),[w,j]=(0,r.useState)(!1),[N,S]=(0,r.useState)([]),[k,C]=(0,r.useState)(!1),[E,$]=(0,r.useState)({isOwner:!1,isEditor:!0,isViewer:!1}),[L,T]=(0,r.useState)(null),[O,A]=(0,r.useState)(!1),[P,z]=(0,r.useState)(null),[B,D]=(0,r.useState)(null);(0,r.useEffect)(()=>{C(!0)},[]),(0,r.useEffect)(()=>{if(!k||!c)return;I();let e=Number(c),t=a.subscribe(e,e=>{"category_updated"===e.type?(console.log(`Category updated for item: ${e.itemName} -> ${e.category}`),S(t=>e.category&&!t.includes(e.category)?[...t,e.category].sort():t)):"connected"!==e.type&&(console.log(`List ${c} updated - refreshing data`),I())});return()=>{t()}},[c,k]);let I=async()=>{try{f(!0);let e=Number(c),t=await o.lists.getById(e);u(t);try{let r=await o.auth.me();if(r){D(r.id);let s=await o.collaborators.getAll(e),l=t.ownerId===r.id,a=s?.find(e=>e.userId===r.id);z(a||null);let i=a?.role==="editor",n=a?.role==="viewer"||!l&&a?.role!=="editor";$({isOwner:l,isEditor:i,isViewer:n})}}catch(e){console.log("Could not fetch user role, assuming editor"),$({isOwner:!1,isEditor:!0,isViewer:!1})}let r=await o.items.getAll(e);p(r);try{let t=await o.lists.getCategories(e);S(t)}catch(t){let e=r.filter(e=>e.category).map(e=>e.category).filter((e,t,r)=>r.indexOf(e)===t);S(e)}}catch(t){let e=t instanceof Error?t.message:"Fehler beim Laden";e.includes("Forbidden")||v(e),console.error(t)}finally{f(!1)}},V=async()=>{if(c&&P&&confirm("Möchtest du diese Liste wirklich verlassen?"))try{await o.collaborators.remove(Number(c),P.id),l.push("/dashboard")}catch(e){v(e instanceof Error?e.message:"Fehler beim Verlassen der Liste")}},K=async()=>{if(c&&P)try{let e=await o.collaborators.accept(Number(c),P.id);z(e),v("")}catch(e){v(e instanceof Error?e.message:"Fehler beim Akzeptieren der Einladung")}},J=async e=>{if(e.preventDefault(),x.trim()&&c){if(E.isViewer)return void v("Du kannst dieser Liste keine Artikel hinzufügen (Viewer-Zugriff)");try{await o.items.create(Number(c),x),g(""),I()}catch(t){let e=t instanceof Error?t.message:"Fehler beim Hinzufügen";e.includes("Forbidden")?v("Du darfst diese Liste nicht bearbeiten"):v(e)}}},F=async(e,t)=>{if(c)try{await o.items.update(Number(c),e,!t),I()}catch(e){v(e instanceof Error?e.message:"Fehler beim Aktualisieren")}},M=async e=>{if(c)try{await o.items.delete(Number(c),e),I()}catch(e){v(e instanceof Error?e.message:"Fehler beim Löschen")}},R=e=>{N.includes(e)||S([...N,e])},H=async e=>{if(c)try{await o.lists.deleteCategory(Number(c),e),S(N.filter(t=>t!==e)),I()}catch(e){v(e instanceof Error?e.message:"Fehler beim Löschen der Kategorie")}},W=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},U=async(e,t)=>{if(e.preventDefault(),!L||L===t||E.isViewer)return void T(null);let r=N.indexOf(L),s=N.indexOf(t);if(-1===r||-1===s)return void T(null);let l=[...N];l.splice(r,1),l.splice(s,0,L),S(l),T(null),A(!0);try{await o.lists.updateCategoryOrder(Number(c),l)}catch(e){S(N),v(e instanceof Error?e.message:"Fehler beim Speichern der Kategorie-Reihenfolge")}finally{A(!1)}};return m?(0,t.jsxs)("div",{className:"min-h-screen bg-[#0a0a0f] flex flex-col",children:[(0,t.jsx)("header",{className:"bg-gradient-to-b from-[#14141f] to-transparent border-b border-[#2d2d3f]/50",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-3 sm:px-6 py-4 sm:py-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center gap-2 sm:gap-4 mb-3 sm:mb-4",children:[(0,t.jsxs)("button",{onClick:()=>l.push("/dashboard"),className:"inline-flex items-center gap-1 sm:gap-2 text-purple-400 hover:text-purple-300 text-xs sm:text-sm font-medium transition-all group flex-shrink-0",children:[(0,t.jsx)("svg",{className:"w-4 h-4 group-hover:-translate-x-1 transition-transform",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Zurück zu Listen"}),(0,t.jsx)("span",{className:"sm:hidden",children:"Zurück"})]}),(0,t.jsxs)("div",{className:"flex gap-1 sm:gap-3 flex-shrink-0",children:[P&&"pending"===P.status&&(0,t.jsxs)("button",{onClick:K,className:"inline-flex items-center gap-1 sm:gap-2 text-green-400 hover:text-green-300 text-xs sm:text-sm font-medium transition-all group",title:"Einladung akzeptieren",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Akzeptieren"})]}),P&&!E.isOwner&&(0,t.jsxs)("button",{onClick:V,className:"inline-flex items-center gap-1 sm:gap-2 text-red-400 hover:text-red-300 text-xs sm:text-sm font-medium transition-all group",title:"Liste verlassen",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Verlassen"})]}),E.isOwner&&(0,t.jsxs)("button",{onClick:()=>j(!0),className:"inline-flex items-center gap-1 sm:gap-2 text-purple-400 hover:text-purple-300 text-xs sm:text-sm font-medium transition-all group",title:"Liste teilen",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Teilen"})]})]})]}),(0,t.jsx)("div",{className:"flex items-center justify-center gap-3 sm:gap-4",children:(0,t.jsxs)("div",{className:"flex-1 text-center",children:[(0,t.jsx)("h1",{className:"text-lg sm:text-3xl font-bold bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent mb-1 sm:mb-2 truncate",children:m.title}),m.description&&(0,t.jsx)("p",{className:"text-gray-400 text-xs sm:text-sm line-clamp-2",children:m.description})]})})]})}),(0,t.jsx)("main",{className:"flex-1 flex flex-col items-center max-w-4xl mx-auto px-3 sm:px-6 py-4 sm:py-8 w-full",children:(0,t.jsxs)("div",{className:"w-full max-w-3xl",children:[y&&(0,t.jsxs)("div",{className:"bg-red-500/10 border border-red-500/30 text-red-400 px-3 sm:px-4 py-2 sm:py-3 rounded-lg sm:rounded-2xl mb-4 sm:mb-6 flex items-center justify-between backdrop-blur-sm",children:[(0,t.jsx)("span",{className:"text-xs sm:text-sm",children:y}),(0,t.jsx)("button",{onClick:()=>v(""),className:"text-red-400 hover:text-red-300 font-bold ml-2 flex-shrink-0",children:"✕"})]}),(0,t.jsxs)("form",{onSubmit:J,className:"mb-4 sm:mb-6 w-full",children:[(0,t.jsxs)("div",{className:"flex gap-2 sm:gap-3",children:[(0,t.jsx)("div",{className:"relative flex-1",children:(0,t.jsx)("input",{type:"text",value:x,onChange:e=>g(e.target.value),placeholder:"Neuen Artikel hinzufügen...",disabled:E.isViewer,className:"w-full px-3 sm:px-5 py-3 sm:py-4 bg-[#14141f] border border-[#2d2d3f] rounded-lg sm:rounded-2xl text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-500/20 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-sm"})}),(0,t.jsxs)("button",{type:"submit",disabled:E.isViewer,className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-3 sm:py-4 px-3 sm:px-6 rounded-lg sm:rounded-2xl transition-all shadow-lg shadow-purple-500/40 hover:shadow-purple-500/60 hover:scale-[1.03] active:scale-95 flex items-center gap-1 sm:gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 flex-shrink-0",children:[(0,t.jsx)("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Hinzufügen"})]})]}),E.isViewer&&(0,t.jsx)("p",{className:"text-yellow-500 text-xs sm:text-sm mt-2",children:"Du hast nur Zugriff als Zuschauer"})]}),0===h.length?(0,t.jsxs)("div",{className:"text-center py-12 sm:py-20 bg-gradient-to-br from-[#14141f] to-[#1a1a2e] border border-[#2d2d3f] rounded-xl sm:rounded-2xl",children:[(0,t.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-white mb-2",children:"Liste ist leer"}),(0,t.jsx)("p",{className:"text-gray-400 text-xs sm:text-sm",children:"Füge deinen ersten Artikel hinzu"})]}):(0,t.jsx)("div",{className:"space-y-3 sm:space-y-4 w-full",children:(Object.keys(e=h.reduce((e,t)=>{let r=t.category||"Ohne Kategorie";return e[r]||(e[r]=[]),e[r].push(t),e},{})).forEach(t=>{e[t].sort((e,t)=>e.completed===t.completed?0:e.completed?1:-1)}),Object.keys(e).sort((e,t)=>{let r=N.indexOf(e),s=N.indexOf(t);return -1!==r&&-1!==s?r-s:-1!==r?-1:-1!==s||"Ohne Kategorie"===e?1:"Ohne Kategorie"===t?-1:e.localeCompare(t)}).map(r=>(0,t.jsxs)("div",{className:"bg-gradient-to-br from-[#14141f] to-[#1a1a2e] border border-[#2d2d3f] rounded-2xl shadow-xl",onDragOver:W,onDrop:e=>U(e,r),children:[(0,t.jsxs)("div",{draggable:!E.isViewer,onDragStart:e=>{!E.isViewer&&(T(r),e.dataTransfer.effectAllowed="move")},className:`bg-purple-500/10 border-b border-[#2d2d3f] px-4 py-3 rounded-t-2xl flex items-center gap-3 transition-all ${!E.isViewer?"cursor-move hover:bg-purple-500/20":""} ${L===r?"opacity-50 bg-purple-500/30":""}`,title:E.isViewer?"":"Kategorie ziehen zum Umsortieren",children:[!E.isViewer&&(0,t.jsx)("svg",{className:"w-5 h-5 text-gray-500 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M9 3h2v2H9V3zm0 4h2v2H9V7zm0 4h2v2H9v-2zm4-8h2v2h-2V3zm0 4h2v2h-2V7zm0 4h2v2h-2v-2z"})}),(0,t.jsx)("h3",{className:"text-sm font-semibold text-purple-400 flex-1",children:r})]}),(0,t.jsx)("ul",{className:"divide-y divide-[#2d2d3f]",children:e[r].map(e=>(0,t.jsx)(d,{id:e.id,name:e.name,category:e.category,completed:e.completed,listId:Number(c),customCategories:N,recipeName:e.recipeName,onToggle:F,onDelete:M,onCategoryChange:I,onAddCategory:R,onDeleteCategory:H,isViewer:E.isViewer},e.id))})]},r)))})]})}),w&&c&&(0,t.jsx)(i,{listId:Number(c),onClose:()=>j(!1)})]}):(0,t.jsx)("div",{className:"min-h-screen bg-[#0a0a0f] flex items-center justify-center",children:(0,t.jsx)("p",{className:"text-gray-400 text-lg",children:"Liste nicht gefunden"})})}e.s(["default",()=>c],21731)}]);